
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wjwillemse.github.io/solvency2-data/api_docs/">
      
      
        <link rel="prev" href="../history/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>API documentation - solvency2-data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="solvency2-data" class="md-header__button md-logo" aria-label="solvency2-data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            solvency2-data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API documentation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/wjwillemse/solvency2-data" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    solvency2-data
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api_example/" class="md-tabs__link">
        
  
    
  
  Using a database

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../history/" class="md-tabs__link">
        
  
    
  
  History

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API documentation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="solvency2-data" class="md-nav__button md-logo" aria-label="solvency2-data" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    solvency2-data
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wjwillemse/solvency2-data" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    solvency2-data
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using a database
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API documentation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API documentation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr" class="md-nav__link">
    <span class="md-ellipsis">
      rfr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.RFR_dict" class="md-nav__link">
    <span class="md-ellipsis">
      RFR_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.RFR_reference_date" class="md-nav__link">
    <span class="md-ellipsis">
      RFR_reference_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.download_RFR" class="md-nav__link">
    <span class="md-ellipsis">
      download_RFR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_govies" class="md-nav__link">
    <span class="md-ellipsis">
      read_govies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_meta" class="md-nav__link">
    <span class="md-ellipsis">
      read_meta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_spot" class="md-nav__link">
    <span class="md-ellipsis">
      read_spot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_spreads" class="md-nav__link">
    <span class="md-ellipsis">
      read_spreads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data" class="md-nav__link">
    <span class="md-ellipsis">
      eiopa_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.add_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      add_to_db
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.download_EIOPA_rates" class="md-nav__link">
    <span class="md-ellipsis">
      download_EIOPA_rates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_govies" class="md-nav__link">
    <span class="md-ellipsis">
      extract_govies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_meta" class="md-nav__link">
    <span class="md-ellipsis">
      extract_meta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_spot_rates" class="md-nav__link">
    <span class="md-ellipsis">
      extract_spot_rates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_spreads" class="md-nav__link">
    <span class="md-ellipsis">
      extract_spreads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_sym_adj" class="md-nav__link">
    <span class="md-ellipsis">
      extract_sym_adj
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.get" class="md-nav__link">
    <span class="md-ellipsis">
      get
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.get_workspace" class="md-nav__link">
    <span class="md-ellipsis">
      get_workspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.validate_date_string" class="md-nav__link">
    <span class="md-ellipsis">
      validate_date_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping" class="md-nav__link">
    <span class="md-ellipsis">
      scraping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.check_if_download" class="md-nav__link">
    <span class="md-ellipsis">
      check_if_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.eiopa_link" class="md-nav__link">
    <span class="md-ellipsis">
      eiopa_link
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.get_links" class="md-nav__link">
    <span class="md-ellipsis">
      get_links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.lookthrough_redirect" class="md-nav__link">
    <span class="md-ellipsis">
      lookthrough_redirect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler" class="md-nav__link">
    <span class="md-ellipsis">
      sqlite_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB" class="md-nav__link">
    <span class="md-ellipsis">
      EiopaDB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EiopaDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.get_set_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_set_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.set_conn" class="md-nav__link">
    <span class="md-ellipsis">
      set_conn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.create_connection" class="md-nav__link">
    <span class="md-ellipsis">
      create_connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.create_eiopa_db" class="md-nav__link">
    <span class="md-ellipsis">
      create_eiopa_db
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.exec_sql" class="md-nav__link">
    <span class="md-ellipsis">
      exec_sql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.smith_wilson" class="md-nav__link">
    <span class="md-ellipsis">
      smith_wilson
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation" class="md-nav__link">
    <span class="md-ellipsis">
      alternative_extrapolation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.DiscountedValue4par2forwards" class="md-nav__link">
    <span class="md-ellipsis">
      DiscountedValue4par2forwards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.FromParToForwards" class="md-nav__link">
    <span class="md-ellipsis">
      FromParToForwards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.create_swap_struct" class="md-nav__link">
    <span class="md-ellipsis">
      create_swap_struct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.forwardstruct2termstruct" class="md-nav__link">
    <span class="md-ellipsis">
      forwardstruct2termstruct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr" class="md-nav__link">
    <span class="md-ellipsis">
      rfr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.RFR_dict" class="md-nav__link">
    <span class="md-ellipsis">
      RFR_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.RFR_reference_date" class="md-nav__link">
    <span class="md-ellipsis">
      RFR_reference_date
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.download_RFR" class="md-nav__link">
    <span class="md-ellipsis">
      download_RFR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read" class="md-nav__link">
    <span class="md-ellipsis">
      read
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_govies" class="md-nav__link">
    <span class="md-ellipsis">
      read_govies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_meta" class="md-nav__link">
    <span class="md-ellipsis">
      read_meta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_spot" class="md-nav__link">
    <span class="md-ellipsis">
      read_spot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.rfr.read_spreads" class="md-nav__link">
    <span class="md-ellipsis">
      read_spreads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data" class="md-nav__link">
    <span class="md-ellipsis">
      eiopa_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.add_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      add_to_db
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.download_EIOPA_rates" class="md-nav__link">
    <span class="md-ellipsis">
      download_EIOPA_rates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_govies" class="md-nav__link">
    <span class="md-ellipsis">
      extract_govies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_meta" class="md-nav__link">
    <span class="md-ellipsis">
      extract_meta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_spot_rates" class="md-nav__link">
    <span class="md-ellipsis">
      extract_spot_rates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_spreads" class="md-nav__link">
    <span class="md-ellipsis">
      extract_spreads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.extract_sym_adj" class="md-nav__link">
    <span class="md-ellipsis">
      extract_sym_adj
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.get" class="md-nav__link">
    <span class="md-ellipsis">
      get
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.get_workspace" class="md-nav__link">
    <span class="md-ellipsis">
      get_workspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.refresh" class="md-nav__link">
    <span class="md-ellipsis">
      refresh
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.eiopa_data.validate_date_string" class="md-nav__link">
    <span class="md-ellipsis">
      validate_date_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping" class="md-nav__link">
    <span class="md-ellipsis">
      scraping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.check_if_download" class="md-nav__link">
    <span class="md-ellipsis">
      check_if_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.eiopa_link" class="md-nav__link">
    <span class="md-ellipsis">
      eiopa_link
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.get_links" class="md-nav__link">
    <span class="md-ellipsis">
      get_links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.scraping.lookthrough_redirect" class="md-nav__link">
    <span class="md-ellipsis">
      lookthrough_redirect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler" class="md-nav__link">
    <span class="md-ellipsis">
      sqlite_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB" class="md-nav__link">
    <span class="md-ellipsis">
      EiopaDB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EiopaDB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.get_set_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_set_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.EiopaDB.set_conn" class="md-nav__link">
    <span class="md-ellipsis">
      set_conn
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.create_connection" class="md-nav__link">
    <span class="md-ellipsis">
      create_connection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.create_eiopa_db" class="md-nav__link">
    <span class="md-ellipsis">
      create_eiopa_db
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.sqlite_handler.exec_sql" class="md-nav__link">
    <span class="md-ellipsis">
      exec_sql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.smith_wilson" class="md-nav__link">
    <span class="md-ellipsis">
      smith_wilson
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation" class="md-nav__link">
    <span class="md-ellipsis">
      alternative_extrapolation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.DiscountedValue4par2forwards" class="md-nav__link">
    <span class="md-ellipsis">
      DiscountedValue4par2forwards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.FromParToForwards" class="md-nav__link">
    <span class="md-ellipsis">
      FromParToForwards
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.create_swap_struct" class="md-nav__link">
    <span class="md-ellipsis">
      create_swap_struct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.alternative_extrapolation.forwardstruct2termstruct" class="md-nav__link">
    <span class="md-ellipsis">
      forwardstruct2termstruct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solvency2_data.util.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="api-documentation">API documentation</h1>


<div class="doc doc-object doc-module">



<a id="solvency2_data.rfr"></a>
  <div class="doc doc-contents first">
  
      <p>Main module.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.RFR_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">RFR_dict</span><span class="p">(</span><span class="n">input_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates a dictionary containing filenames based on the reference date
and other data derived from it.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input date in the format "%Y-%m-%d".
Defaults to None, which means the current date is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store intermediate and final results.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing generated filenames and other data.
The dictionary includes the following keys:
    - "input_date": The input date in the format "%Y-%m-%d".
    - "reference_date": The reference date in the format "%Y%m%d".
    - "name_excelfile": The filename for the EIOPA RFR term structures Excel file.
    - "name_excelfile_spreads": The filename for the EIOPA RFR PD Cod Excel file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">RFR_dict</span><span class="p">(</span><span class="n">input_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a dictionary containing filenames based on the reference date</span>
<span class="sd">    and other data derived from it.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_date (str, optional): The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            Defaults to None, which means the current date is used.</span>
<span class="sd">        cache (dict, optional): A dictionary to store intermediate and final results.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing generated filenames and other data.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;input_date&quot;: The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">                - &quot;reference_date&quot;: The reference date in the format &quot;%Y%m%d&quot;.</span>
<span class="sd">                - &quot;name_excelfile&quot;: The filename for the EIOPA RFR term structures Excel file.</span>
<span class="sd">                - &quot;name_excelfile_spreads&quot;: The filename for the EIOPA RFR PD Cod Excel file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">RFR_reference_date</span><span class="p">(</span><span class="n">input_date</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;EIOPA_RFR_&quot;</span> <span class="o">+</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;reference_date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_Term_Structures&quot;</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="p">)</span>
    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile_spreads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;EIOPA_RFR_&quot;</span> <span class="o">+</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;reference_date&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_PD_Cod&quot;</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.RFR_reference_date" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">RFR_reference_date</span><span class="p">(</span><span class="n">input_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the reference date based on the input date or the current date.
If no input date is provided or if the input date is in the future,
it defaults to the current date. If the current date is before the 5th of the month,
it sets the reference date to the last day of the previous month.
Otherwise, it sets the reference date to the next day after the input date.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input date in the format "%Y-%m-%d".
Defaults to None, which means the current date is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store the calculated reference date.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the input date and the reference date.
The input date is stored under the key "input_date" in the format "%Y-%m-%d".
The reference date is stored under the key "reference_date" in the format "%Y%m%d".</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">RFR_reference_date</span><span class="p">(</span><span class="n">input_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the reference date based on the input date or the current date.</span>
<span class="sd">    If no input date is provided or if the input date is in the future,</span>
<span class="sd">    it defaults to the current date. If the current date is before the 5th of the month,</span>
<span class="sd">    it sets the reference date to the last day of the previous month.</span>
<span class="sd">    Otherwise, it sets the reference date to the next day after the input date.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_date (str, optional): The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            Defaults to None, which means the current date is used.</span>
<span class="sd">        cache (dict, optional): A dictionary to store the calculated reference date.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the input date and the reference date.</span>
<span class="sd">            The input date is stored under the key &quot;input_date&quot; in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            The reference date is stored under the key &quot;reference_date&quot; in the format &quot;%Y%m%d&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">input_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">input_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_date</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">reference_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">reference_date</span> <span class="o">&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()):</span>
        <span class="n">reference_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">reference_date</span><span class="o">.</span><span class="n">day</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">reference_date</span> <span class="o">=</span> <span class="n">reference_date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_date</span> <span class="o">=</span> <span class="n">reference_date</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># to do : check if end of month</span>
    <span class="n">reference_date</span> <span class="o">=</span> <span class="n">reference_date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;input_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reference_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;reference_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;input_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.download_RFR" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">download_RFR</span><span class="p">(</span><span class="n">input_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Downloads EIOPA RFR (Risk-Free Rate) files for a given date and saves them locally.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input date in the format "%Y-%m-%d".
Defaults to None, which means the current date is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store intermediate and final results.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing information about the downloaded files and paths.
The dictionary includes the following keys:
    - "input_date": The input date in the format "%Y-%m-%d".
    - "reference_date": The reference date in the format "%Y%m%d".
    - "name_excelfile": The filename for the downloaded EIOPA RFR term structures Excel file.
    - "name_excelfile_spreads": The filename for the downloaded EIOPA RFR PD Cod Excel file.
    - "url": The URL from which the files were downloaded.
    - "name_zipfile": The name of the downloaded zip file.
    - "path_excelfile": The path where the Excel files are saved.
    - "path_zipfile": The path where the zip file is saved.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_RFR</span><span class="p">(</span><span class="n">input_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads EIOPA RFR (Risk-Free Rate) files for a given date and saves them locally.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_date (str, optional): The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            Defaults to None, which means the current date is used.</span>
<span class="sd">        cache (dict, optional): A dictionary to store intermediate and final results.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing information about the downloaded files and paths.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;input_date&quot;: The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">                - &quot;reference_date&quot;: The reference date in the format &quot;%Y%m%d&quot;.</span>
<span class="sd">                - &quot;name_excelfile&quot;: The filename for the downloaded EIOPA RFR term structures Excel file.</span>
<span class="sd">                - &quot;name_excelfile_spreads&quot;: The filename for the downloaded EIOPA RFR PD Cod Excel file.</span>
<span class="sd">                - &quot;url&quot;: The URL from which the files were downloaded.</span>
<span class="sd">                - &quot;name_zipfile&quot;: The name of the downloaded zip file.</span>
<span class="sd">                - &quot;path_excelfile&quot;: The path where the Excel files are saved.</span>
<span class="sd">                - &quot;path_zipfile&quot;: The path where the zip file is saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">RFR_dict</span><span class="p">(</span><span class="n">input_date</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile&quot;</span><span class="p">]))</span>
    <span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile_spreads&quot;</span><span class="p">]))</span>
    <span class="p">):</span>
        <span class="c1"># determine correct url and zipfile</span>
        <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eiopa_link</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;input_date&quot;</span><span class="p">],</span> <span class="n">data_type</span><span class="o">=</span><span class="s2">&quot;rfr&quot;</span><span class="p">)</span>
        <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_zipfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;filename=&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># download file</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">])</span>

        <span class="c1"># save zip-file</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_zipfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_zipfile&quot;</span><span class="p">]),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
        <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">name_excelfile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">name_excelfile_spreads</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">zip_ref</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_zipfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_zipfile&quot;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zip_ref</span><span class="o">.</span><span class="n">namelist</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">name_excelfile</span> <span class="o">=</span> <span class="n">name</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile_spreads&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">name_excelfile_spreads</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">name_excelfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">name_excelfile</span><span class="p">,</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">name_excelfile_spreads</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">name_excelfile_spreads</span><span class="p">,</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">])</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># remove zip file</span>
        <span class="c1"># os.remove(cache[&#39;path_zipfile&#39;] + cache[&quot;name_zipfile&quot;])</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.read" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read</span><span class="p">(</span><span class="n">input_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads data from Excel files and stores it in a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input date in the format "%Y-%m-%d".
Defaults to None, which means the current date is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the directory containing Excel files.
If None, it looks for .cfg files in the current directory or the package directory.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the read data.
The dictionary includes various keys storing downloaded files, metadata, spot data, spreadsheets, etc.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="n">input_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads data from Excel files and stores it in a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_date (str, optional): The input date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            Defaults to None, which means the current date is used.</span>
<span class="sd">        path (str, optional): The path to the directory containing Excel files.</span>
<span class="sd">            If None, it looks for .cfg files in the current directory or the package directory.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the read data.</span>
<span class="sd">            The dictionary includes various keys storing downloaded files, metadata, spot data, spreadsheets, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># look in current directory for .cfg file</span>
        <span class="c1"># if not exists then take the .cfg file in the package directory</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Directories&quot;</span><span class="p">)</span>

        <span class="n">path_zipfile</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;zip_files&quot;</span><span class="p">)</span>
        <span class="n">path_excelfile</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;excel_files&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">path_zipfile</span> <span class="o">=</span> <span class="n">path</span>
        <span class="n">path_excelfile</span> <span class="o">=</span> <span class="n">path</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_zipfile&quot;</span><span class="p">:</span> <span class="n">path_zipfile</span><span class="p">,</span> <span class="s2">&quot;path_excelfile&quot;</span><span class="p">:</span> <span class="n">path_excelfile</span><span class="p">}</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="n">download_RFR</span><span class="p">(</span><span class="n">input_date</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span>
        <span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile&quot;</span><span class="p">]),</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span>
    <span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">read_meta</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">read_spot</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">xls_spreads</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span>
        <span class="n">join</span><span class="p">(</span><span class="n">cache</span><span class="p">[</span><span class="s2">&quot;path_excelfile&quot;</span><span class="p">],</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;name_excelfile_spreads&quot;</span><span class="p">]),</span>
        <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">read_spreads</span><span class="p">(</span><span class="n">xls_spreads</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">read_govies</span><span class="p">(</span><span class="n">xls_spreads</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>

    <span class="n">xls</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">xls_spreads</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.read_govies" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_govies</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads central government fundamental spreads from an Excel file and stores them in a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>xls</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An object representing the Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store the read spreadsheets.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the read spreadsheets.
The dictionary includes the following keys:
    - "central government fundamental spreads": A DataFrame containing central government spreads.
The DataFrame includes spreads for various financial attributes indexed by dates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_govies</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads central government fundamental spreads from an Excel file and stores them in a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        xls : An object representing the Excel file.</span>
<span class="sd">        cache (dict, optional): A dictionary to store the read spreadsheets.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the read spreadsheets.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;central government fundamental spreads&quot;: A DataFrame containing central government spreads.</span>
<span class="sd">            The DataFrame includes spreads for various financial attributes indexed by dates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;central government fundamental spreads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;FS_Govts&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">xls</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
                <span class="n">io</span><span class="o">=</span><span class="n">xls</span><span class="p">,</span>
                <span class="n">sheet_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="s2">&quot;B:AF&quot;</span><span class="p">,</span>
                <span class="n">nrows</span><span class="o">=</span><span class="mi">53</span><span class="p">,</span>
                <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">skiprows</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># This line introduces a dependency on the spots</span>
            <span class="c1"># df.index = cache[&#39;RFR_spot_no_VA&#39;].columns</span>
            <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;central government fundamental spreads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.read_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_meta</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads metadata from an Excel file and stores it in a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>xls</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An object representing the Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store the read metadata.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the read metadata.
The dictionary includes the following key:
    - "meta": DataFrame containing metadata.
The DataFrame includes metadata indexed by "meta" and may include information
such as headers, column descriptions, and other relevant details.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_meta</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads metadata from an Excel file and stores it in a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        xls : An object representing the Excel file.</span>
<span class="sd">        cache (dict, optional): A dictionary to store the read metadata.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the read metadata.</span>
<span class="sd">            The dictionary includes the following key:</span>
<span class="sd">                - &quot;meta&quot;: DataFrame containing metadata.</span>
<span class="sd">            The DataFrame includes metadata indexed by &quot;meta&quot; and may include information</span>
<span class="sd">            such as headers, column descriptions, and other relevant details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
        <span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;RFR_spot_with_VA&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skipfooter</span><span class="o">=</span><span class="mi">150</span>
    <span class="p">)</span>
    <span class="c1"># drop unnamed columns from the excel file</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_meta</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;Unnamed:&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">df_meta</span> <span class="o">=</span> <span class="n">df_meta</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df_meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;VA&quot;</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">infer_objects</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_meta</span> <span class="o">=</span> <span class="n">df_meta</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">df_meta</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]</span>
    <span class="n">df_meta</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_meta</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Info&quot;</span><span class="p">)</span>

    <span class="c1"># Reference date is not strictly part of meta</span>
    <span class="c1"># df_append = pd.DataFrame(index=[&#39;reference date&#39;],</span>
    <span class="c1">#                          columns=df_meta.columns)</span>
    <span class="c1"># # df_append.loc[&#39;reference date&#39;] = cache[&quot;reference_date&quot;]</span>
    <span class="c1"># df_meta = df_meta.append(df_append)</span>

    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_meta</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.read_spot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_spot</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads various spot data from an Excel file and stores them in a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>xls</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An object representing the Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store the read spot data.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the read spot data.
The dictionary includes the following keys:
    - "RFR_spot_no_VA": DataFrame containing spot data without VA.
    - "RFR_spot_with_VA": DataFrame containing spot data with VA.
    - "Spot_NO_VA_shock_UP": DataFrame containing spot data without VA with UP shock.
    - "Spot_NO_VA_shock_DOWN": DataFrame containing spot data without VA with DOWN shock.
    - "Spot_WITH_VA_shock_UP": DataFrame containing spot data with VA with UP shock.
    - "Spot_WITH_VA_shock_DOWN": DataFrame containing spot data with VA with DOWN shock.
Each DataFrame contains spot data indexed by duration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_spot</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads various spot data from an Excel file and stores them in a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        xls : An object representing the Excel file.</span>
<span class="sd">        cache (dict, optional): A dictionary to store the read spot data.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the read spot data.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;RFR_spot_no_VA&quot;: DataFrame containing spot data without VA.</span>
<span class="sd">                - &quot;RFR_spot_with_VA&quot;: DataFrame containing spot data with VA.</span>
<span class="sd">                - &quot;Spot_NO_VA_shock_UP&quot;: DataFrame containing spot data without VA with UP shock.</span>
<span class="sd">                - &quot;Spot_NO_VA_shock_DOWN&quot;: DataFrame containing spot data without VA with DOWN shock.</span>
<span class="sd">                - &quot;Spot_WITH_VA_shock_UP&quot;: DataFrame containing spot data with VA with UP shock.</span>
<span class="sd">                - &quot;Spot_WITH_VA_shock_DOWN&quot;: DataFrame containing spot data with VA with DOWN shock.</span>
<span class="sd">            Each DataFrame contains spot data indexed by duration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;RFR_spot_no_VA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RFR_spot_with_VA&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_NO_VA_shock_UP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_NO_VA_shock_DOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_WITH_VA_shock_UP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_WITH_VA_shock_DOWN&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">xls</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
                <span class="n">io</span><span class="o">=</span><span class="n">xls</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">158</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="c1"># drop unnamed columns from the excel file</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;Unnamed:&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;VA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">infer_objects</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Duration&quot;</span><span class="p">]</span>
            <span class="n">cache</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.rfr.read_spreads" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">read_spreads</span><span class="p">(</span><span class="n">xls</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads financial and non-financial fundamental spreads from an Excel file and stores them in a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>xls</code></td>
          <td>
                <code><span title="pandas.ExcelFile">ExcelFile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An ExcelFile object containing the spreadsheets.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cache</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary to store the read spreadsheets.
Defaults to an empty dictionary.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the read spreadsheets.
The dictionary includes the following keys:
    - "financial fundamental spreads": A dictionary containing financial spreadsheets
        for different currencies.
    - "non-financial fundamental spreads": A dictionary containing non-financial spreadsheets
        for different currencies.
Each sub-dictionary contains DataFrames with financial or non-financial spreads
for the respective currencies.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\rfr.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_spreads</span><span class="p">(</span><span class="n">xls</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">,</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads financial and non-financial fundamental spreads from an Excel file and stores them in a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        xls (pd.ExcelFile): An ExcelFile object containing the spreadsheets.</span>
<span class="sd">        cache (dict, optional): A dictionary to store the read spreadsheets.</span>
<span class="sd">            Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the read spreadsheets.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;financial fundamental spreads&quot;: A dictionary containing financial spreadsheets</span>
<span class="sd">                    for different currencies.</span>
<span class="sd">                - &quot;non-financial fundamental spreads&quot;: A dictionary containing non-financial spreadsheets</span>
<span class="sd">                    for different currencies.</span>
<span class="sd">            Each sub-dictionary contains DataFrames with financial or non-financial spreads</span>
<span class="sd">            for the respective currencies.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;financial fundamental spreads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">currencies</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">xls</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
                <span class="n">io</span><span class="o">=</span><span class="n">xls</span><span class="p">,</span>
                <span class="n">sheet_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="s2">&quot;W:AC&quot;</span><span class="p">,</span>
                <span class="n">nrows</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                <span class="n">skiprows</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
            <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;financial fundamental spreads&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>

    <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;non-financial fundamental spreads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">currencies</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">xls</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
                <span class="n">io</span><span class="o">=</span><span class="n">xls</span><span class="p">,</span>
                <span class="n">sheet_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="s2">&quot;W:AC&quot;</span><span class="p">,</span>
                <span class="n">nrows</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                <span class="n">skiprows</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
            <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;non-financial fundamental spreads&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>

    <span class="k">return</span> <span class="n">cache</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<a id="solvency2_data.eiopa_data"></a>
  <div class="doc doc-contents first">
  
      <p>Downloads rfr and stores in sqlite database for future reference</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.add_to_db" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_to_db</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;rfr&#39;</span><span class="p">,</span> <span class="n">workspace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Adds data to the EIOPA database, to use when you are missing data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The reference date in the format "%Y-%m-%d".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>db</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="solvency2_data.sqlite_handler.EiopaDB" href="#solvency2_data.sqlite_handler.EiopaDB">EiopaDB</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The EIOPA database instance.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of data to add.
Options: "rfr" (default), "meta", "spreads", "govies", "sym_adj".</p>
            </div>
          </td>
          <td>
                <code>&#39;rfr&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>workspace</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing workspace directories and paths.
If None, it retrieves workspace information using get_workspace() function.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_to_db</span><span class="p">(</span>
    <span class="n">ref_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span> <span class="n">EiopaDB</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="n">workspace</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds data to the EIOPA database, to use when you are missing data.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_date (str): The reference date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">        db (EiopaDB): The EIOPA database instance.</span>
<span class="sd">        data_type (str, optional): The type of data to add.</span>
<span class="sd">            Options: &quot;rfr&quot; (default), &quot;meta&quot;, &quot;spreads&quot;, &quot;govies&quot;, &quot;sym_adj&quot;.</span>
<span class="sd">        workspace (dict, optional): A dictionary containing workspace directories and paths.</span>
<span class="sd">            If None, it retrieves workspace information using get_workspace() function.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">eiopa_link</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">)</span>
    <span class="n">set_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_set_id</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data_type</span> <span class="o">!=</span> <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">download_EIOPA_rates</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;rfr&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">extract_spot_rates</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">data_type</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">extract_meta</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">data_type</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;spreads&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">extract_spreads</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">data_type</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;govies&quot;</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">extract_govies</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">data_type</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span>
    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">workspace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">workspace</span> <span class="o">=</span> <span class="n">get_workspace</span><span class="p">()</span>
        <span class="n">raw_folder</span> <span class="o">=</span> <span class="n">workspace</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">]</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">extract_sym_adj</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;url_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_id</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ref_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_date</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">set_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;govies&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="s2">&quot;spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">}</span>
        <span class="n">db</span><span class="o">.</span><span class="n">update_catalog</span><span class="p">(</span>
            <span class="n">url_id</span><span class="o">=</span><span class="n">set_id</span><span class="p">,</span>
            <span class="n">dict_vals</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;set_type&quot;</span><span class="p">:</span> <span class="n">set_types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">data_type</span><span class="p">),</span>
                <span class="s2">&quot;primary_set&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;ref_date&quot;</span><span class="p">:</span> <span class="n">ref_date</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.download_EIOPA_rates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">download_EIOPA_rates</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">,</span> <span class="n">workspace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Downloads EIOPA RFR (Risk-Free Rate) files from a given URL and extracts them.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>url</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The URL from which to download the EIOPA RFR files.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The reference date in the format "%Y-%m-%d".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>workspace</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing workspace directories and paths.
If None, it retrieves workspace information using get_workspace() function.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the paths to the downloaded files.
The dictionary includes the following keys:
    - "rfr": The path to the downloaded EIOPA RFR term structures Excel file.
    - "meta": The path to the downloaded EIOPA RFR meta Excel file.
    - "spreads": The path to the downloaded EIOPA RFR PD Cod Excel file.
    - "govies": The path to the downloaded EIOPA RFR govvies Excel file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_EIOPA_rates</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">workspace</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads EIOPA RFR (Risk-Free Rate) files from a given URL and extracts them.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL from which to download the EIOPA RFR files.</span>
<span class="sd">        ref_date (str): The reference date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">        workspace (dict, optional): A dictionary containing workspace directories and paths.</span>
<span class="sd">            If None, it retrieves workspace information using get_workspace() function.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the paths to the downloaded files.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;rfr&quot;: The path to the downloaded EIOPA RFR term structures Excel file.</span>
<span class="sd">                - &quot;meta&quot;: The path to the downloaded EIOPA RFR meta Excel file.</span>
<span class="sd">                - &quot;spreads&quot;: The path to the downloaded EIOPA RFR PD Cod Excel file.</span>
<span class="sd">                - &quot;govies&quot;: The path to the downloaded EIOPA RFR govvies Excel file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">workspace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">workspace</span> <span class="o">=</span> <span class="n">get_workspace</span><span class="p">()</span>
    <span class="n">raw_folder</span> <span class="o">=</span> <span class="n">workspace</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">]</span>
    <span class="n">zip_file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">)</span>

    <span class="c1"># Change format of ref_date string for EIOPA Excel files from YYYY-mm-dd to YYYYmmdd:</span>
    <span class="n">reference_date</span> <span class="o">=</span> <span class="n">ref_date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">name_excelfile</span> <span class="o">=</span> <span class="s2">&quot;EIOPA_RFR_&quot;</span> <span class="o">+</span> <span class="n">reference_date</span> <span class="o">+</span> <span class="s2">&quot;_Term_Structures&quot;</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="n">name_excelfile_spreads</span> <span class="o">=</span> <span class="s2">&quot;EIOPA_RFR_&quot;</span> <span class="o">+</span> <span class="n">reference_date</span> <span class="o">+</span> <span class="s2">&quot;_PD_Cod&quot;</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>
    <span class="c1"># Making file paths string insensitve via regex</span>
    <span class="n">re_rfr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(?i:</span><span class="si">{</span><span class="n">name_excelfile</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">re_spreads</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(?i:</span><span class="si">{</span><span class="n">name_excelfile_spreads</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipobj</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">zipobj</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
            <span class="n">res_rfr</span> <span class="o">=</span> <span class="n">re_rfr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">res_spreads</span> <span class="o">=</span> <span class="n">re_spreads</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res_rfr</span><span class="p">:</span>
                <span class="n">rfr_file</span> <span class="o">=</span> <span class="n">res_rfr</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">zipobj</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">rfr_file</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res_spreads</span><span class="p">:</span>
                <span class="n">spreads_file</span> <span class="o">=</span> <span class="n">res_spreads</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">zipobj</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">spreads_file</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;rfr&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">,</span> <span class="n">name_excelfile</span><span class="p">),</span>
        <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">,</span> <span class="n">name_excelfile</span><span class="p">),</span>
        <span class="s2">&quot;spreads&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">,</span> <span class="n">name_excelfile_spreads</span><span class="p">),</span>
        <span class="s2">&quot;govies&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">,</span> <span class="n">name_excelfile_spreads</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.download_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Downloads a file from a URL and saves it in a specified folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>url</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The URL of the file to download.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>raw_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the directory where the file will be saved.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The desired filename. If not provided,
the filename will be derived from the URL. Defaults to "".</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the downloaded file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raw_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Downloads a file from a URL and saves it in a specified folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the file to download.</span>
<span class="sd">        raw_folder (str): The path to the directory where the file will be saved.</span>
<span class="sd">        filename (str, optional): The desired filename. If not provided,</span>
<span class="sd">            the filename will be derived from the URL. Defaults to &quot;&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The path to the downloaded file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="n">url</span><span class="p">[(</span><span class="n">url</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span> <span class="p">:]</span>
        <span class="k">if</span> <span class="n">extension</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="n">extension</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if filename not specified, then the file name will be the original file name</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">url</span><span class="p">[(</span><span class="n">url</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:]</span>
        <span class="c1"># make sure that the filename does not contain illegal characters</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^\w_. -]&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;.zip&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span>

    <span class="n">target_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">target_file</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;file already exists in this location, not downloading&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">raw_folder</span><span class="p">)</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">target_file</span><span class="p">)</span>  <span class="c1"># simpler for file downloading</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;file downloaded and saved in the following location: &quot;</span> <span class="o">+</span> <span class="n">target_file</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">target_file</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.extract_govies" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_govies</span><span class="p">(</span><span class="n">govies_filepath</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts government spreads data from an EIOPA RFR spreads Excel file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>govies_filepath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the EIOPA RFR spreads Excel file containing government spreads.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pandas.DataFrame or None: A DataFrame containing extracted government spreads data,
indexed by country code and duration.
Returns None if no government spreads are found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_govies</span><span class="p">(</span><span class="n">govies_filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts government spreads data from an EIOPA RFR spreads Excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        govies_filepath (str): The path to the EIOPA RFR spreads Excel file containing government spreads.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame or None: A DataFrame containing extracted government spreads data,</span>
<span class="sd">            indexed by country code and duration.</span>
<span class="sd">            Returns None if no government spreads are found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting govies: &quot;</span> <span class="o">+</span> <span class="n">govies_filepath</span><span class="p">)</span>
    <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">govies_filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">read_govies</span><span class="p">(</span><span class="n">xls</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;central government fundamental spreads&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">spreads_gov</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;central government fundamental spreads&quot;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">stack</span><span class="p">()</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;spread&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">spreads_gov</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="s2">&quot;country_code&quot;</span><span class="p">]</span>
        <span class="n">spreads_gov</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">spreads_gov</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No govies found: &quot;</span> <span class="o">+</span> <span class="n">govies_filepath</span><span class="p">)</span>
        <span class="n">spreads_gov</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">spreads_gov</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.extract_meta" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_meta</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts metadata from an EIOPA RFR Excel file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rfr_filepath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the EIOPA RFR Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing extracted metadata.
The dictionary includes metadata indexed by country.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_meta</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts metadata from an EIOPA RFR Excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        rfr_filepath (str): The path to the EIOPA RFR Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing extracted metadata.</span>
<span class="sd">            The dictionary includes metadata indexed by country.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting meta data :&quot;</span> <span class="o">+</span> <span class="n">rfr_filepath</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">read_meta</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">)</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">meta</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">()</span>
    <span class="n">meta</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Country&quot;</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">meta</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.extract_spot_rates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_spot_rates</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts spot rates from an EIOPA RFR Excel file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rfr_filepath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the EIOPA RFR Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing extracted spot rates.
The dictionary includes spot rates indexed by scenario, currency code, and duration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_spot_rates</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts spot rates from an EIOPA RFR Excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        rfr_filepath (str): The path to the EIOPA RFR Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing extracted spot rates.</span>
<span class="sd">            The dictionary includes spot rates indexed by scenario, currency code, and duration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting spots: &quot;</span> <span class="o">+</span> <span class="n">rfr_filepath</span><span class="p">)</span>
    <span class="c1"># TODO: Complete this remap dictionary</span>
    <span class="n">currency_codes_and_regions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;EUR&quot;</span><span class="p">:</span> <span class="s2">&quot;Euro&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PLN&quot;</span><span class="p">:</span> <span class="s2">&quot;Poland&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CHF&quot;</span><span class="p">:</span> <span class="s2">&quot;Switzerland&quot;</span><span class="p">,</span>
        <span class="s2">&quot;USD&quot;</span><span class="p">:</span> <span class="s2">&quot;United States&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GBP&quot;</span><span class="p">:</span> <span class="s2">&quot;United Kingdom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NOK&quot;</span><span class="p">:</span> <span class="s2">&quot;Norway&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SEK&quot;</span><span class="p">:</span> <span class="s2">&quot;Sweden&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DKK&quot;</span><span class="p">:</span> <span class="s2">&quot;Denmark&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HRK&quot;</span><span class="p">:</span> <span class="s2">&quot;Croatia&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">currency_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">currency_codes_and_regions</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">rfr_filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">read_spot</span><span class="p">(</span><span class="n">xls</span><span class="p">)</span>

    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">rates_tables</span><span class="p">)</span>
    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">rates_tables</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">currency_dict</span><span class="p">)[</span><span class="n">currency_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>

    <span class="n">label_remap</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;RFR_spot_no_VA&quot;</span><span class="p">:</span> <span class="s2">&quot;base&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RFR_spot_with_VA&quot;</span><span class="p">:</span> <span class="s2">&quot;va&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_NO_VA_shock_UP&quot;</span><span class="p">:</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_NO_VA_shock_DOWN&quot;</span><span class="p">:</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_WITH_VA_shock_UP&quot;</span><span class="p">:</span> <span class="s2">&quot;va_up&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Spot_WITH_VA_shock_DOWN&quot;</span><span class="p">:</span> <span class="s2">&quot;va_down&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">rates_tables</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">label_remap</span><span class="p">)</span>

    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">rates_tables</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;spot&quot;</span><span class="p">)</span>

    <span class="n">rates_tables</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scenario&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="s2">&quot;currency_code&quot;</span><span class="p">]</span>
    <span class="n">rates_tables</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">rates_tables</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">rates_tables</span> <span class="o">=</span> <span class="n">rates_tables</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">rates_tables</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.extract_spreads" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_spreads</span><span class="p">(</span><span class="n">spread_filepath</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts spreads data from an EIOPA RFR spreads Excel file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spread_filepath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the EIOPA RFR spreads Excel file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pandas.DataFrame: A DataFrame containing extracted spreads data.
The DataFrame includes spreads indexed by type, currency code, credit curve step, and duration.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_spreads</span><span class="p">(</span><span class="n">spread_filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts spreads data from an EIOPA RFR spreads Excel file.</span>

<span class="sd">    Args:</span>
<span class="sd">        spread_filepath (str): The path to the EIOPA RFR spreads Excel file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame containing extracted spreads data.</span>
<span class="sd">            The DataFrame includes spreads indexed by type, currency code, credit curve step, and duration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Extracting spreads: &quot;</span> <span class="o">+</span> <span class="n">spread_filepath</span><span class="p">)</span>
    <span class="n">xls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">spread_filepath</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
    <span class="n">spreads</span> <span class="o">=</span> <span class="n">read_spreads</span><span class="p">(</span><span class="n">xls</span><span class="p">)</span>
    <span class="n">spreads_non_gov</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">i</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">spreads</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;financial fundamental spreads&quot;</span><span class="p">,</span>
                <span class="s2">&quot;non-financial fundamental spreads&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">spreads_non_gov</span> <span class="o">=</span> <span class="n">spreads_non_gov</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;spread&quot;</span><span class="p">)</span>
    <span class="n">spreads_non_gov</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;currency_code&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="s2">&quot;cc_step&quot;</span><span class="p">]</span>
    <span class="n">spreads_non_gov</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">spreads_non_gov</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">reorder_levels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">spreads_non_gov</span> <span class="o">=</span> <span class="n">spreads_non_gov</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;financial fundamental spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;fin&quot;</span><span class="p">,</span>
            <span class="s2">&quot;non-financial fundamental spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;non_fin&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">spreads_non_gov</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.extract_sym_adj" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extract_sym_adj</span><span class="p">(</span><span class="n">sym_adj_filepath</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Extracts symmetric adjustment data from a file.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sym_adj_filepath</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to the file containing symmetric adjustment data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The reference date in the format "%Y-%m-%d".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.DataFrame or None: A DataFrame containing symmetric adjustment data.
Returns None if there is a date mismatch between the reference date provided
and the date in the file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_sym_adj</span><span class="p">(</span><span class="n">sym_adj_filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts symmetric adjustment data from a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        sym_adj_filepath (str): The path to the file containing symmetric adjustment data.</span>
<span class="sd">        ref_date (str): The reference date in the format &quot;%Y-%m-%d&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame or None: A DataFrame containing symmetric adjustment data.</span>
<span class="sd">            Returns None if there is a date mismatch between the reference date provided</span>
<span class="sd">            and the date in the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
        <span class="n">sym_adj_filepath</span><span class="p">,</span>
        <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Symmetric_adjustment&quot;</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="s2">&quot;E, K&quot;</span><span class="p">,</span>
        <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">skiprows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ref_date&quot;</span><span class="p">,</span> <span class="s2">&quot;sym_adj&quot;</span><span class="p">],</span>
    <span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>

    <span class="n">input_ref</span> <span class="o">=</span> <span class="n">ref_date</span>
    <span class="n">ref_check</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ref_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">input_ref</span> <span class="o">!=</span> <span class="n">ref_check</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Date mismatch in sym_adj file: &quot;</span> <span class="o">+</span> <span class="n">sym_adj_filepath</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Try opening this file and setting the date correctly then save and close, and rerun.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;ref_date&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.get" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;rfr&#39;</span><span class="p">,</span> <span class="n">workspace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves data from the EIOPA database for a given reference date and data type.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The reference date in the format "%Y-%m-%d".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of data to retrieve.
Options: "rfr" (default), "meta", "spreads", "govies", "sym_adj".</p>
            </div>
          </td>
          <td>
                <code>&#39;rfr&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>workspace</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing workspace directories and paths.
If None, it retrieves workspace information using get_workspace() function.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pandas.DataFrame or None: A DataFrame containing retrieved data.
Returns None if no data is found for the given reference date and data type.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">ref_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="n">workspace</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves data from the EIOPA database for a given reference date and data type.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_date (str): The reference date in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">        data_type (str, optional): The type of data to retrieve.</span>
<span class="sd">            Options: &quot;rfr&quot; (default), &quot;meta&quot;, &quot;spreads&quot;, &quot;govies&quot;, &quot;sym_adj&quot;.</span>
<span class="sd">        workspace (dict, optional): A dictionary containing workspace directories and paths.</span>
<span class="sd">            If None, it retrieves workspace information using get_workspace() function.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame or None: A DataFrame containing retrieved data.</span>
<span class="sd">            Returns None if no data is found for the given reference date and data type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate the provided ref_date:</span>
    <span class="n">ref_date</span> <span class="o">=</span> <span class="n">validate_date_string</span><span class="p">(</span><span class="n">ref_date</span><span class="p">)</span>
    <span class="c1"># Check if DB exists, if not, create it:</span>
    <span class="k">if</span> <span class="n">workspace</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">workspace</span> <span class="o">=</span> <span class="n">get_workspace</span><span class="p">()</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">workspace</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">]</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">EiopaDB</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>

    <span class="n">sql_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;rfr&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM rfr WHERE ref_date = &#39;&quot;</span> <span class="o">+</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM meta WHERE ref_date = &#39;&quot;</span> <span class="o">+</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM spreads WHERE ref_date = &#39;&quot;</span> <span class="o">+</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;govies&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM govies WHERE ref_date = &#39;&quot;</span> <span class="o">+</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span> <span class="s2">&quot;SELECT * FROM sym_adj WHERE ref_date = &#39;&quot;</span> <span class="o">+</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="n">sql_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">add_to_db</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">data_type</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">conn</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;url_id&quot;</span><span class="p">,</span> <span class="s2">&quot;ref_date&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.get_workspace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_workspace</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves workspace directories and paths from the configuration.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing workspace directories and paths.
The dictionary includes the following keys:
    - "database": The path to the EIOPA database file.
    - "raw_data": The path to the directory containing raw data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_workspace</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves workspace directories and paths from the configuration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing workspace directories and paths.</span>
<span class="sd">            The dictionary includes the following keys:</span>
<span class="sd">                - &quot;database&quot;: The path to the EIOPA database file.</span>
<span class="sd">                - &quot;raw_data&quot;: The path to the directory containing raw data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Directories&quot;</span><span class="p">)</span>
    <span class="n">path_db</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;db_folder&quot;</span><span class="p">)</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_db</span><span class="p">,</span> <span class="s2">&quot;eiopa.db&quot;</span><span class="p">)</span>
    <span class="n">path_raw</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="n">database</span><span class="p">,</span> <span class="s2">&quot;raw_data&quot;</span><span class="p">:</span> <span class="n">path_raw</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.refresh" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">refresh</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Refreshes the EIOPA database by updating data for each month from January 2016 to the current month.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A message indicating that the database has been successfully rebuilt.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">refresh</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Refreshes the EIOPA database by updating data for each month from January 2016 to the current month.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A message indicating that the database has been successfully rebuilt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">(),</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span>
    <span class="c1"># dr = pd.date_range(date(2021, 11, 30), date.today(), freq=&quot;M&quot;)</span>
    <span class="k">for</span> <span class="n">ref_date</span> <span class="ow">in</span> <span class="n">dr</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">,</span> <span class="s2">&quot;spreads&quot;</span><span class="p">,</span> <span class="s2">&quot;govies&quot;</span><span class="p">,</span> <span class="s2">&quot;sym_adj&quot;</span><span class="p">]:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">ref_date</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span> <span class="n">data_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;Database successfully rebuilt&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.eiopa_data.validate_date_string" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">validate_date_string</span><span class="p">(</span><span class="n">ref_date</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Validates the input date string.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str or <span title="datetime.date">date</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input date string or datetime.date object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>str or None: A validated date string in the format "%Y-%m-%d".
Returns None if the input date type is not recognized or cannot be converted.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\eiopa_data.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_date_string</span><span class="p">(</span><span class="n">ref_date</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the input date string.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_date (str or datetime.date): The input date string or datetime.date object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str or None: A validated date string in the format &quot;%Y-%m-%d&quot;.</span>
<span class="sd">            Returns None if the input date type is not recognized or cannot be converted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ref_date</span><span class="p">)</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ref_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Date type not recognised. Try datetime.date or YYYY-mm-dd&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<a id="solvency2_data.scraping"></a>
  <div class="doc doc-contents first">
  
      <p>Returns links for EIOPA files</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="solvency2_data.scraping.check_if_download" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_if_download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Checks if the URL points to a downloadable resource.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>url</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The URL to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the resource is downloadable, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\scraping.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_if_download</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the URL points to a downloadable resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the resource is downloadable, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">headers</span>
    <span class="c1"># downloadable = &#39;attachment&#39; in headers.get(&#39;Content-Disposition&#39;, &#39;&#39;)</span>
    <span class="n">downloadable</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;application/zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">downloadable</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.scraping.eiopa_link" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eiopa_link</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;rfr&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates the link for downloading the selected type of data for a given date.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ref_date</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The reference date in the format 'YYYY-MM-DD'.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>data_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The type of the dataset. Defaults to 'rfr'.</p>
            </div>
          </td>
          <td>
                <code>&#39;rfr&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The valid link to the dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <p>from datetime import date
import pandas as pd
dr = pd.date_range(date(2016, 1, 31), date(2023, 5, 31), freq='M')
rfr_links = {i.strftime('%Y%m%d'): eiopa_link(i.strftime('%Y-%m-%d')) for i in dr}
sym_adj_links = {i.strftime('%Y%m%d'): eiopa_link(i.strftime('%Y-%m-%d'), 'sym_adj') for i in dr}</p>
</details>
          <details class="quote">
            <summary>Source code in <code>solvency2_data\scraping.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eiopa_link</span><span class="p">(</span><span class="n">ref_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rfr&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates the link for downloading the selected type of data for a given date.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_date (str): The reference date in the format &#39;YYYY-MM-DD&#39;.</span>
<span class="sd">        data_type (str, optional): The type of the dataset. Defaults to &#39;rfr&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The valid link to the dataset.</span>

<span class="sd">    Example:</span>
<span class="sd">        from datetime import date</span>
<span class="sd">        import pandas as pd</span>
<span class="sd">        dr = pd.date_range(date(2016, 1, 31), date(2023, 5, 31), freq=&#39;M&#39;)</span>
<span class="sd">        rfr_links = {i.strftime(&#39;%Y%m%d&#39;): eiopa_link(i.strftime(&#39;%Y-%m-%d&#39;)) for i in dr}</span>
<span class="sd">        sym_adj_links = {i.strftime(&#39;%Y%m%d&#39;): eiopa_link(i.strftime(&#39;%Y-%m-%d&#39;), &#39;sym_adj&#39;) for i in dr}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_type_remap</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="s2">&quot;govies&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">,</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="s2">&quot;rfr&quot;</span><span class="p">}</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="n">data_type_remap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">data_type</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="n">urls_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
    <span class="c1"># Change format of ref_date string for EIOPA Excel files from YYYY-mm-dd to YYYYmmdd:</span>
    <span class="n">reference_date</span> <span class="o">=</span> <span class="n">ref_date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ref_date_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">ref_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">str_year</span> <span class="o">=</span> <span class="n">ref_date_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">)</span>
    <span class="n">str_month</span> <span class="o">=</span> <span class="n">ref_date_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;rfr&quot;</span><span class="p">:</span>
        <span class="c1"># eiopa uses two naming conventions for the files</span>
        <span class="n">filename1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;.*(?i:filename=)(?:</span><span class="si">%E</span><span class="s2">2</span><span class="si">%80%</span><span class="s2">8B)?&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;(?i:&quot;</span>
            <span class="o">+</span> <span class="n">str_month</span>
            <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;(?:[-, _]|%20)&quot;</span>
            <span class="o">+</span> <span class="n">str_year</span>
            <span class="o">+</span> <span class="s2">&quot;.*&quot;</span>
            <span class="s2">&quot;.*&quot;</span>
        <span class="p">)</span>
        <span class="n">filename2</span> <span class="o">=</span> <span class="s2">&quot;.*EIOPA_RFR_&quot;</span> <span class="o">+</span> <span class="n">reference_date</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">filename1</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">filename2</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span>
        <span class="c1"># Regex to find the file :</span>
        <span class="c1"># ._ required for ._march_2019</span>
        <span class="c1"># Only matches on first 3 letters of months since some mis-spellings</span>
        <span class="n">words_in_link</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;symmetric&quot;</span><span class="p">,</span> <span class="s2">&quot;adjustment&quot;</span><span class="p">,</span> <span class="s2">&quot;equity&quot;</span><span class="p">,</span> <span class="s2">&quot;capital&quot;</span><span class="p">,</span> <span class="s2">&quot;charge&quot;</span><span class="p">]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="s2">&quot;.*(?i:eiopa)(?:[-, _]|%20)&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;(?:[-, _]|%20)&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words_in_link</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;(?:[-, _]|%20)&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;(?i:&quot;</span>
            <span class="o">+</span> <span class="n">str_month</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;[a-z]{0,&quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str_month</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;}(?:[-, _]|%20)&quot;</span>
            <span class="o">+</span> <span class="n">str_year</span>
            <span class="o">+</span> <span class="s2">&quot;(?:_[0-9]{0,1})?(?:.xlsx|$)&quot;</span>
        <span class="p">)</span>

    <span class="n">valid_link</span> <span class="o">=</span> <span class="n">get_links</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

    <span class="n">problem_dates</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rfr&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2021-11-30&quot;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="n">ref_date</span> <span class="ow">in</span> <span class="n">problem_dates</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">valid_link</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_link</span><span class="p">:</span>
        <span class="n">manual_links</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;2020-06-30&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.eiopa.europa.eu/system/files/2020-06/eiopa_symmetric_adjustment_equity_capital_charge_16_06_2020.xlsx&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2020-07-31&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.eiopa.europa.eu/system/files/2020-07/eiopa_symmetric_adjustment_equity_capital_charge_14_07_2020.xlsx&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;rfr&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;2021-11-30&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.eiopa.europa.eu/system/files/2021-12/eiopa_rfr_20211130.zip&quot;</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="n">valid_link</span> <span class="o">=</span> <span class="n">manual_links</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ref_date</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_link</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
            <span class="s2">&quot;Error: no EIOPA file found for date: &quot;</span>
            <span class="o">+</span> <span class="n">ref_date</span>
            <span class="o">+</span> <span class="s2">&quot;; Source: &quot;</span>
            <span class="o">+</span> <span class="n">data_type</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">valid_link</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.scraping.get_links" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_links</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Retrieves valid download links from a list of URLs.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>urls</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of URLs to search for links.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>r</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pattern to match for links.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of valid download links.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\scraping.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_links</span><span class="p">(</span><span class="n">urls</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves valid download links from a list of URLs.</span>

<span class="sd">    Args:</span>
<span class="sd">        urls (str): A list of URLs to search for links.</span>
<span class="sd">        r (str): The pattern to match for links.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of valid download links.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">raw_links</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_links</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;href&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">}):</span>
                <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                    <span class="c1"># correct relative urls</span>
                    <span class="n">link_before_redirect</span> <span class="o">=</span> <span class="s2">&quot;https://www.eiopa.europa.eu&quot;</span> <span class="o">+</span> <span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                        <span class="s2">&quot;href&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">link_before_redirect</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span>
                <span class="c1"># Check if there is a redirect:</span>
                <span class="n">raw_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">link_before_redirect</span><span class="p">)</span>

    <span class="n">valid_links</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">raw_links</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check_if_download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
            <span class="n">valid_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">redirect</span> <span class="o">=</span> <span class="n">lookthrough_redirect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">check_if_download</span><span class="p">(</span><span class="n">redirect</span><span class="p">):</span>
                <span class="n">valid_links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">redirect</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_links</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">valid_links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.scraping.lookthrough_redirect" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">lookthrough_redirect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Looks through redirects and returns the final URL.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>url</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The URL to look through.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>str</code></td>          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The final URL after following redirects.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\scraping.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">lookthrough_redirect</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Looks through redirects and returns the final URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to look through.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The final URL after following redirects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">file_url</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">file_url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="k">return</span> <span class="n">file_url</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<a id="solvency2_data.sqlite_handler"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains all the handler functions for the sqlite database storing the data</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="solvency2_data.sqlite_handler.EiopaDB" class="doc doc-heading">
          <code>EiopaDB</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>object</code></p>

  
      <p>Database object to store the EIOPA data.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="solvency2_data.sqlite_handler.EiopaDB.database">database</span></code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the database file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="solvency2_data.sqlite_handler.EiopaDB.__init__" href="#solvency2_data.sqlite_handler.EiopaDB.__init__">__init__</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Initialize database object.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="solvency2_data.sqlite_handler.EiopaDB.reset" href="#solvency2_data.sqlite_handler.EiopaDB.reset">reset</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Hard reset of the database.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="solvency2_data.sqlite_handler.EiopaDB.set_conn" href="#solvency2_data.sqlite_handler.EiopaDB.set_conn">set_conn</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Set database connection.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><span title="solvency2_data.sqlite_handler.EiopaDB._close_conn">_close_conn</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Close database connection.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="solvency2_data.sqlite_handler.EiopaDB.get_set_id" href="#solvency2_data.sqlite_handler.EiopaDB.get_set_id">get_set_id</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Get the URL ID for a URL.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><span title="solvency2_data.sqlite_handler.EiopaDB._add_set">_add_set</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Add a new URL to the catalog.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><span title="solvency2_data.sqlite_handler.EiopaDB.update_catalog">update_catalog</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Update the catalog with new values.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EiopaDB</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Database object to store the EIOPA data.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        database (str): Path to the database file.</span>

<span class="sd">    Methods:</span>
<span class="sd">        __init__(database): Initialize database object.</span>
<span class="sd">        reset(): Hard reset of the database.</span>
<span class="sd">        set_conn(): Set database connection.</span>
<span class="sd">        _close_conn(): Close database connection.</span>
<span class="sd">        get_set_id(url): Get the URL ID for a URL.</span>
<span class="sd">        _add_set(url): Add a new URL to the catalog.</span>
<span class="sd">        update_catalog(url_id, dict_vals): Update the catalog with new values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            database (str): Path to the database file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">database</span><span class="p">):</span>
            <span class="n">root_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root_folder</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">root_folder</span><span class="p">)</span>
            <span class="n">create_eiopa_db</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_conn</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;DB initialised&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hard reset of the database</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_close_conn</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="n">create_eiopa_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_conn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set database connection</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_close_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close database connection</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the url id for a url</span>
<span class="sd">        If not there, check if valid then add</span>

<span class="sd">        Args:</span>
<span class="sd">            url: url to be found</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">set_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="s2">&quot;SELECT url_id FROM catalog WHERE url = &#39;&quot;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">set_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_id</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Cursor returns a tuple and only want id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">set_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_set</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">set_id</span>

    <span class="k">def</span> <span class="nf">_add_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Private method, only called when url not already in catalog&quot;&quot;&quot;</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO catalog (url) VALUES (&#39;&quot;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cur</span><span class="o">.</span><span class="n">lastrowid</span>

    <span class="k">def</span> <span class="nf">update_catalog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dict_vals</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">set_lines</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dict_vals</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;UPDATE catalog SET </span><span class="si">%s</span><span class="s2"> WHERE url_id=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">set_lines</span><span class="p">,</span> <span class="n">url_id</span><span class="p">)</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="solvency2_data.sqlite_handler.EiopaDB.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">database</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize the database.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>database</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the database file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        database (str): Path to the database file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">database</span><span class="p">):</span>
        <span class="n">root_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">root_folder</span><span class="p">)</span>
        <span class="n">create_eiopa_db</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_conn</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;DB initialised&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="solvency2_data.sqlite_handler.EiopaDB.get_set_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_set_id</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the url id for a url
If not there, check if valid then add</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>url</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>url to be found</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the url id for a url</span>
<span class="sd">    If not there, check if valid then add</span>

<span class="sd">    Args:</span>
<span class="sd">        url: url to be found</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">set_id</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="s2">&quot;SELECT url_id FROM catalog WHERE url = &#39;&quot;</span> <span class="o">+</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="n">set_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">set_id</span> <span class="o">=</span> <span class="n">set_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Cursor returns a tuple and only want id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">set_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_set</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">set_id</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="solvency2_data.sqlite_handler.EiopaDB.reset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Hard reset of the database</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hard reset of the database</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close_conn</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
    <span class="n">create_eiopa_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_conn</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="solvency2_data.sqlite_handler.EiopaDB.set_conn" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_conn</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set database connection</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set database connection</span>

<span class="sd">    Args:</span>
<span class="sd">        None</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="solvency2_data.sqlite_handler.create_connection" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_connection</span><span class="p">(</span><span class="n">database</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>create a database connection to the SQLite database</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>database</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>database specified by database file path</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>connection object or None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_connection</span><span class="p">(</span><span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    create a database connection to the SQLite database</span>

<span class="sd">    Args:</span>
<span class="sd">        database: database specified by database file path</span>

<span class="sd">    Returns:</span>
<span class="sd">        connection object or None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">conn</span>
    <span class="k">except</span> <span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">conn</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.sqlite_handler.create_eiopa_db" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_eiopa_db</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">&#39;eiopa.db&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Create the EIOPA database</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>database</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>name of the database to be created</p>
            </div>
          </td>
          <td>
                <code>&#39;eiopa.db&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_eiopa_db</span><span class="p">(</span><span class="n">database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;eiopa.db&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the EIOPA database</span>

<span class="sd">    Args:</span>
<span class="sd">        database: name of the database to be created</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_def</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot; CREATE TABLE IF NOT EXISTS catalog (</span>
<span class="s2">                                     url_id INTEGER NOT NULL PRIMARY KEY,</span>
<span class="s2">                                     url TEXT,</span>
<span class="s2">                                     set_type TEXT,</span>
<span class="s2">                                     primary_set BOOLEAN,</span>
<span class="s2">                                     ref_date TEXT</span>
<span class="s2">                                     ); &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot; CREATE TABLE IF NOT EXISTS meta (</span>
<span class="s2">                                     url_id INTEGER NOT NULL,</span>
<span class="s2">                                     ref_date TEXT,</span>
<span class="s2">                                     Country TEXT,</span>
<span class="s2">                                     Info TEXT,</span>
<span class="s2">                                     Coupon_freq INTEGER,</span>
<span class="s2">                                     LLP INTEGER,</span>
<span class="s2">                                     Convergence INTEGER,</span>
<span class="s2">                                     UFR REAL,</span>
<span class="s2">                                     alpha REAL,</span>
<span class="s2">                                     CRA REAL,</span>
<span class="s2">                                     VA REAL,</span>
<span class="s2">                                     FOREIGN KEY (url_id) REFERENCES catalog (url_id)</span>
<span class="s2">                                        ON DELETE CASCADE ON UPDATE NO ACTION</span>
<span class="s2">                                     ); &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rfr&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot; CREATE TABLE IF NOT EXISTS rfr (</span>
<span class="s2">                                     url_id INTEGER NOT NULL,</span>
<span class="s2">                                     ref_date TEXT,</span>
<span class="s2">                                     scenario TEXT,</span>
<span class="s2">                                     currency_code TEXT,</span>
<span class="s2">                                     duration INTEGER,</span>
<span class="s2">                                     spot REAL,</span>
<span class="s2">                                     FOREIGN KEY (url_id) REFERENCES catalog (url_id)</span>
<span class="s2">                                        ON DELETE CASCADE ON UPDATE NO ACTION</span>
<span class="s2">                                     ); &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spreads&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS spreads (</span>
<span class="s2">                                        url_id INTEGER NOT NULL,</span>
<span class="s2">                                        ref_date TEXT,</span>
<span class="s2">                                        type TEXT,</span>
<span class="s2">                                        currency_code TEXT,</span>
<span class="s2">                                        duration INTEGER,</span>
<span class="s2">                                        cc_step INTEGER,</span>
<span class="s2">                                        spread REAL,</span>
<span class="s2">                                        FOREIGN KEY (url_id) REFERENCES catalog (url_id)</span>
<span class="s2">                                        ON DELETE CASCADE ON UPDATE NO ACTION</span>
<span class="s2">                                        );&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;govies&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS govies (</span>
<span class="s2">                                            url_id INTEGER NOT NULL,</span>
<span class="s2">                                            ref_date TEXT,</span>
<span class="s2">                                            country_code TEXT,</span>
<span class="s2">                                            duration INTEGER,</span>
<span class="s2">                                            spread REAL,</span>
<span class="s2">                                            FOREIGN KEY (url_id) REFERENCES catalog (url_id)</span>
<span class="s2">                                        ON DELETE CASCADE ON UPDATE NO ACTION</span>
<span class="s2">                                            );&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sym_adj&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;CREATE TABLE IF NOT EXISTS sym_adj (</span>
<span class="s2">                                    url_id INTEGER NOT NULL,</span>
<span class="s2">                                    ref_date TEXT,</span>
<span class="s2">                                    sym_adj REAL,</span>
<span class="s2">                                    FOREIGN KEY (url_id) REFERENCES catalog (url_id)</span>
<span class="s2">                                ON DELETE CASCADE ON UPDATE NO ACTION</span>
<span class="s2">                                    );&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># create a database connection</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">database</span><span class="p">)</span>
    <span class="c1"># create tables</span>
    <span class="k">if</span> <span class="n">conn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># create tables</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">table_def</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">exec_sql</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error! cannot create the database connection.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.sqlite_handler.exec_sql" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exec_sql</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">sql</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Execute sql in connection</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>conn</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>database connection</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sql</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sql statement to be executed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\sqlite_handler.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exec_sql</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute sql in connection</span>

<span class="sd">    Args:</span>
<span class="sd">        conn: database connection</span>
<span class="sd">        sql: sql statement to be executed</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">




<a id="solvency2_data.smith_wilson"></a>
  <div class="doc doc-contents first">
  
      <p>Calculates Smith-Wilson parameters and returns output based on the specified parameters.</p>
<p>Note: Prices of all instruments are set to 1 by construction.
Hence 1: if Instrument = Zero then for Zero i there is only one pay-off
of (1+r(i))^u(i) at time u(i).
Hence 2: if Instrument = Swap or Bond then for Swap/Bond i there are
pay-offs of r(i)/nrofcoup at time 1/nrofcoup, 2/nrofcoup, ...
u(i)-1/nrofcoup plus a final pay-off of 1+r(i)/nrofcoup at time u(i).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>instrument</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of financial instrument. Default is "Zero".</p>
            </div>
          </td>
          <td>
                <code>&#39;Zero&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>liquid_maturities</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Liquid maturities.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>RatesIn</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input dictionary for RatesIn.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
        <tr>
          <td><code>nrofcoup</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of Coupon Payments per Year. Default is 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>cra</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Credit Risk Adjustment in basispoints. Default is 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>ufr</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Ultimate Forward Rate annual compounded (perunage). Default is 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>min_alfa</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Minimum value for alfa. Default is 0.05.</p>
            </div>
          </td>
          <td>
                <code>0.05</code>
          </td>
        </tr>
        <tr>
          <td><code>tau</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tau value. Default is 1.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>T2</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Convergence Maturity. Default is 60.</p>
            </div>
          </td>
          <td>
                <code>60</code>
          </td>
        </tr>
        <tr>
          <td><code>precision</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Precision value. Default is 6.</p>
            </div>
          </td>
          <td>
                <code>6</code>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Calculation method. Default is "brute_force".</p>
            </div>
          </td>
          <td>
                <code>&#39;brute_force&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of output. Default is "zero rates annual compounding".</p>
            </div>
          </td>
          <td>
                <code>&#39;zero rates annual compounding&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>output</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Calculated output based on the specified parameters.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>instrument = "Zero"
liquid_maturities = [1, 2, 3, 4, 5]
RatesIn = {0: 0.02, 1: 0.025, 2: 0.03, 3: 0.035, 4: 0.04, 5: 0.045}
nrofcoup = 2
cra = 0.01
ufr = 0.05
min_alfa = 0.05
tau = 1
T2 = 60
precision = 6
method = "brute_force"
output_type = "zero rates annual compounding"
smith_wilson(instrument, liquid_maturities, RatesIn, nrofcoup, cra, ufr, min_alfa, tau, T2, precision, method, output_type)
array([0.        , 0.01984642, 0.04040711, 0.06171705, 0.08381221,
       0.10672926, 0.13050535, 0.15517806, 0.18078504, 0.20736481,
       0.23495648, 0.26360038, 0.29333873, 0.3242144 , 0.35627157,
       0.3895553 , 0.42411294, 0.4599934 , 0.49724737, 0.53592752,
       0.57608986, 0.61779295, 0.66109833, 0.70607181, 0.75278461,
       0.80131366, 0.85174183, 0.90415729, 0.95865366, 1.01533039,
       1.0742924 , 1.13564943, 1.19951555, 1.26601055, 1.33526045,
       1.40739786, 1.48256135, 1.5608958 , 1.6425528 , 1.72769014,
       1.81647324, 1.90907556, 2.00567914, 2.10647707, 2.21167306,
       2.32148215, 2.43613139, 2.55586064, 2.68092039, 2.81157657,
       2.94810739, 3.09080731, 3.23998602, 3.39596949, 3.559099  ,
       3.72973118, 3.90823814, 4.09500861, 4.29045285, 4.49400082,
       4.70510529, 4.92324198, 5.14791281, 5.37864303, 5.61498852,
       5.85652901, 6.10287445, 6.35366537, 6.6085712 , 6.86728774,
       7.12954064, 7.395082  , 7.66368905, 7.93516083, 8.20931788,
       8.48599994, 8.76506649, 9.04639664, 9.329887  , 9.61545067,
       9.90301596, 10.19252555, 10.48393262, 10.77720086, 11.07230382,
       11.36922416, 11.66795383, 11.96849432, 12.27085209, 12.57503994,
       12.88007745, 13.18599135, 13.49281377, 13.80058263, 14.109341  ,
       14.41913647, 14.73002158, 15.04205535, 15.35530365, 15.66983964,
       15.98574325, 16.30310069, 16.62199494, 16.94251238, 17.2647438 ,
       17.5887832 , 17.91472858, 18.24268076, 18.5727421 , 18.90502131,
       19.23963426, 19.57670285, 19.9163558 , 20.25872748, 20.60395864,
       20.95219615, 21.30359381, 21.65831201, 22.01651854, 22.3783874 ])</p>
</blockquote>
</blockquote>
</blockquote>
</details>
          <details class="quote">
            <summary>Source code in <code>solvency2_data\smith_wilson.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">smith_wilson</span><span class="p">(</span>
    <span class="n">instrument</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Zero&quot;</span><span class="p">,</span>
    <span class="n">liquid_maturities</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">RatesIn</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">nrofcoup</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">cra</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">ufr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">min_alfa</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">tau</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">T2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
    <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;brute_force&quot;</span><span class="p">,</span>
    <span class="n">output_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;zero rates annual compounding&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Smith-Wilson parameters and returns output based on the specified parameters.</span>

<span class="sd">    Note: Prices of all instruments are set to 1 by construction.</span>
<span class="sd">    Hence 1: if Instrument = Zero then for Zero i there is only one pay-off</span>
<span class="sd">    of (1+r(i))^u(i) at time u(i).</span>
<span class="sd">    Hence 2: if Instrument = Swap or Bond then for Swap/Bond i there are</span>
<span class="sd">    pay-offs of r(i)/nrofcoup at time 1/nrofcoup, 2/nrofcoup, ...</span>
<span class="sd">    u(i)-1/nrofcoup plus a final pay-off of 1+r(i)/nrofcoup at time u(i).</span>

<span class="sd">    Args:</span>
<span class="sd">        instrument (str): Type of financial instrument. Default is &quot;Zero&quot;.</span>
<span class="sd">        liquid_maturities (list): Liquid maturities.</span>
<span class="sd">        RatesIn (dict): Input dictionary for RatesIn.</span>
<span class="sd">        nrofcoup (int): Number of Coupon Payments per Year. Default is 1.</span>
<span class="sd">        cra (float): Credit Risk Adjustment in basispoints. Default is 0.</span>
<span class="sd">        ufr (float): Ultimate Forward Rate annual compounded (perunage). Default is 0.</span>
<span class="sd">        min_alfa (float): Minimum value for alfa. Default is 0.05.</span>
<span class="sd">        tau (float): Tau value. Default is 1.</span>
<span class="sd">        T2 (int): Convergence Maturity. Default is 60.</span>
<span class="sd">        precision (int): Precision value. Default is 6.</span>
<span class="sd">        method (str): Calculation method. Default is &quot;brute_force&quot;.</span>
<span class="sd">        output_type (str): Type of output. Default is &quot;zero rates annual compounding&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        output: Calculated output based on the specified parameters.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; instrument = &quot;Zero&quot;</span>
<span class="sd">        &gt;&gt;&gt; liquid_maturities = [1, 2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; RatesIn = {0: 0.02, 1: 0.025, 2: 0.03, 3: 0.035, 4: 0.04, 5: 0.045}</span>
<span class="sd">        &gt;&gt;&gt; nrofcoup = 2</span>
<span class="sd">        &gt;&gt;&gt; cra = 0.01</span>
<span class="sd">        &gt;&gt;&gt; ufr = 0.05</span>
<span class="sd">        &gt;&gt;&gt; min_alfa = 0.05</span>
<span class="sd">        &gt;&gt;&gt; tau = 1</span>
<span class="sd">        &gt;&gt;&gt; T2 = 60</span>
<span class="sd">        &gt;&gt;&gt; precision = 6</span>
<span class="sd">        &gt;&gt;&gt; method = &quot;brute_force&quot;</span>
<span class="sd">        &gt;&gt;&gt; output_type = &quot;zero rates annual compounding&quot;</span>
<span class="sd">        &gt;&gt;&gt; smith_wilson(instrument, liquid_maturities, RatesIn, nrofcoup, cra, ufr, min_alfa, tau, T2, precision, method, output_type)</span>
<span class="sd">        array([0.        , 0.01984642, 0.04040711, 0.06171705, 0.08381221,</span>
<span class="sd">               0.10672926, 0.13050535, 0.15517806, 0.18078504, 0.20736481,</span>
<span class="sd">               0.23495648, 0.26360038, 0.29333873, 0.3242144 , 0.35627157,</span>
<span class="sd">               0.3895553 , 0.42411294, 0.4599934 , 0.49724737, 0.53592752,</span>
<span class="sd">               0.57608986, 0.61779295, 0.66109833, 0.70607181, 0.75278461,</span>
<span class="sd">               0.80131366, 0.85174183, 0.90415729, 0.95865366, 1.01533039,</span>
<span class="sd">               1.0742924 , 1.13564943, 1.19951555, 1.26601055, 1.33526045,</span>
<span class="sd">               1.40739786, 1.48256135, 1.5608958 , 1.6425528 , 1.72769014,</span>
<span class="sd">               1.81647324, 1.90907556, 2.00567914, 2.10647707, 2.21167306,</span>
<span class="sd">               2.32148215, 2.43613139, 2.55586064, 2.68092039, 2.81157657,</span>
<span class="sd">               2.94810739, 3.09080731, 3.23998602, 3.39596949, 3.559099  ,</span>
<span class="sd">               3.72973118, 3.90823814, 4.09500861, 4.29045285, 4.49400082,</span>
<span class="sd">               4.70510529, 4.92324198, 5.14791281, 5.37864303, 5.61498852,</span>
<span class="sd">               5.85652901, 6.10287445, 6.35366537, 6.6085712 , 6.86728774,</span>
<span class="sd">               7.12954064, 7.395082  , 7.66368905, 7.93516083, 8.20931788,</span>
<span class="sd">               8.48599994, 8.76506649, 9.04639664, 9.329887  , 9.61545067,</span>
<span class="sd">               9.90301596, 10.19252555, 10.48393262, 10.77720086, 11.07230382,</span>
<span class="sd">               11.36922416, 11.66795383, 11.96849432, 12.27085209, 12.57503994,</span>
<span class="sd">               12.88007745, 13.18599135, 13.49281377, 13.80058263, 14.109341  ,</span>
<span class="sd">               14.41913647, 14.73002158, 15.04205535, 15.35530365, 15.66983964,</span>
<span class="sd">               15.98574325, 16.30310069, 16.62199494, 16.94251238, 17.2647438 ,</span>
<span class="sd">               17.5887832 , 17.91472858, 18.24268076, 18.5727421 , 18.90502131,</span>
<span class="sd">               19.23963426, 19.57670285, 19.9163558 , 20.25872748, 20.60395864,</span>
<span class="sd">               20.95219615, 21.30359381, 21.65831201, 22.01651854, 22.3783874 ])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">instrument</span> <span class="o">==</span> <span class="s2">&quot;Zero&quot;</span> <span class="ow">and</span> <span class="n">nrofcoup</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="p">),</span> <span class="s2">&quot;instrument is zero bond, but with nrofcoup unequal to 1.&quot;</span>
    <span class="k">assert</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;brute_force&quot;</span><span class="p">,</span> <span class="s2">&quot;Only brute force method is implemented.&quot;</span>
    <span class="k">assert</span> <span class="n">instrument</span> <span class="o">==</span> <span class="s2">&quot;Zero&quot;</span><span class="p">,</span> <span class="s2">&quot;No other instruments implemented yet.&quot;</span>

    <span class="c1"># the number of liquid rates</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">liquid_maturities</span><span class="p">)</span>
    <span class="c1"># nrofcoup * maximum liquid maturity</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">nrofcoup</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">liquid_maturities</span><span class="p">)</span>

    <span class="n">log_ufr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">ufr</span><span class="p">)</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span> <span class="o">/</span> <span class="mi">10000</span>
    <span class="n">cra</span> <span class="o">=</span> <span class="n">cra</span> <span class="o">/</span> <span class="mi">10000</span>

    <span class="c1"># Q&#39; matrix according to 146 of specs;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q_matrix</span><span class="p">(</span><span class="n">instrument</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">liquid_maturities</span><span class="p">,</span> <span class="n">RatesIn</span><span class="p">,</span> <span class="n">nrofcoup</span><span class="p">,</span> <span class="n">cra</span><span class="p">,</span> <span class="n">log_ufr</span><span class="p">)</span>

    <span class="c1"># Determine optimal alfa with corresponding gamma</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;brute_force&quot;</span><span class="p">:</span>
        <span class="n">alfa</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">optimal_alfa</span><span class="p">(</span><span class="n">min_alfa</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">nrofcoup</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
    <span class="n">alfa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">alfa</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Now the SW-present value function according to 154 of the specs can be</span>
    <span class="c1"># calculated: p(v)=exp(-lnUFR*v)*(1+H(v,u)*Qb)</span>
    <span class="c1"># The G(v,u) matrix for maturities v = 1 to 121 according to 142 of the</span>
    <span class="c1"># technical specs (Note: maturity 121 will not be used; see later)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">j</span> <span class="o">/</span> <span class="n">nrofcoup</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">,</span>
            <span class="n">alfa</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alfa</span> <span class="o">*</span> <span class="n">j</span> <span class="o">/</span> <span class="n">nrofcoup</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="n">alfa</span> <span class="o">*</span> <span class="n">i</span><span class="p">)),</span>
            <span class="n">alfa</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alfa</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">alfa</span> <span class="o">*</span> <span class="n">j</span> <span class="o">/</span> <span class="n">nrofcoup</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="p">(</span><span class="mi">121</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># The H(v,u) matrix for maturities v = 1 to 121 according to 139</span>
    <span class="c1"># of the technical specs</span>
    <span class="c1"># h[i, j] = big_h(alfa * i, alfa * (j+1) / nrofcoup) -&gt; strange,</span>
    <span class="c1"># is different from earlier def</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">big_h</span><span class="p">(</span><span class="n">alfa</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="n">nrofcoup</span><span class="p">,</span> <span class="n">alfa</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrofcoup</span><span class="p">),</span> <span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># First a temporary discount-vector will be used to store the in-between</span>
    <span class="c1"># result H(v,u)*Qb = #(v,u)*gamma (see 154 of the specs)</span>
    <span class="n">temptempdiscount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
    <span class="c1"># Calculating G(v,u)*Qb according to 158 of the specs</span>
    <span class="n">temptempintensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

    <span class="n">tempdiscount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">tempintensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">121</span><span class="p">):</span>
        <span class="n">tempdiscount</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temptempdiscount</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tempintensity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temptempintensity</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># calculating (1&#39;-exp(-alfa*u&#39;))Qb as subresult for 160 of specs</span>
    <span class="n">res1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alfa</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">nrofcoup</span><span class="p">))</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># yield intensities</span>
    <span class="n">yldintensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">yldintensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_ufr</span> <span class="o">-</span> <span class="n">alfa</span> <span class="o">*</span> <span class="n">res1</span>  <span class="c1"># calculating 160 of the specs</span>
    <span class="c1"># calculating 158 of the specs for maturity 1 year</span>
    <span class="n">yldintensity</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">log_ufr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tempdiscount</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">121</span><span class="p">)</span>

    <span class="c1"># forward intensities # calculating 158 of the specs for higher maturities</span>
    <span class="n">fwintensity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">fwintensity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_ufr</span> <span class="o">-</span> <span class="n">alfa</span> <span class="o">*</span> <span class="n">res1</span>  <span class="c1"># calculating 160 of the specs</span>
    <span class="n">fwintensity</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">log_ufr</span> <span class="o">-</span> <span class="n">tempintensity</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tempdiscount</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="c1"># discount rates</span>
    <span class="n">discount</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">discount</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">discount</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">log_ufr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">121</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tempdiscount</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

    <span class="c1"># forward rates annual compounding</span>
    <span class="n">forwardac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">forwardac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">forwardac</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">discount</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">discount</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># zero rates annual compounding</span>
    <span class="n">zeroac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">zeroac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">zeroac</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">discount</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">121</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;zero rates annual compounding&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">zeroac</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;forward rate annual compounding&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">forwardac</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;discount rates&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">discount</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;forward intensities&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">fwintensity</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;yield intensities&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">yldintensity</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">&quot;alfa&quot;</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">alfa</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>

<div class="doc doc-object doc-module">



<a id="solvency2_data.alternative_extrapolation"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="solvency2_data.alternative_extrapolation.DiscountedValue4par2forwards" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">DiscountedValue4par2forwards</span><span class="p">(</span><span class="n">sum_df</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_df</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">par_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">forward_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_min_k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the discounted value for two-factor parallel forwards.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sum_df</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sum of discount factors. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>last_df</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The last discount factor. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>par_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The par rate. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>forward_rate</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The forward rate. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>t_min_k</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The difference between the two terms. Defaults to 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>float</code></td>          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The calculated discounted value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\alternative_extrapolation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">DiscountedValue4par2forwards</span><span class="p">(</span>
    <span class="n">sum_df</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">last_df</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">par_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">forward_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">t_min_k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the discounted value for two-factor parallel forwards.</span>

<span class="sd">    Args:</span>
<span class="sd">        sum_df (float, optional): The sum of discount factors. Defaults to 0.</span>
<span class="sd">        last_df (float, optional): The last discount factor. Defaults to 0.</span>
<span class="sd">        par_rate (float, optional): The par rate. Defaults to 0.</span>
<span class="sd">        forward_rate (float, optional): The forward rate. Defaults to 0.</span>
<span class="sd">        t_min_k (int, optional): The difference between the two terms. Defaults to 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The calculated discounted value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">disc_val_1</span> <span class="o">=</span> <span class="n">sum_df</span> <span class="o">*</span> <span class="n">par_rate</span>
    <span class="n">disc_val_2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">t_min_k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">disc_val_1</span> <span class="o">+=</span> <span class="n">par_rate</span> <span class="o">*</span> <span class="n">last_df</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">forward_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">disc_val_2</span> <span class="o">-=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">par_rate</span> <span class="o">*</span> <span class="n">last_df</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">forward_rate</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">disc_val_1</span> <span class="o">+=</span> <span class="n">last_df</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">forward_rate</span><span class="p">)</span> <span class="o">**</span> <span class="n">t_min_k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">disc_val_2</span> <span class="o">-=</span> <span class="n">t_min_k</span> <span class="o">*</span> <span class="n">last_df</span> <span class="o">/</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">forward_rate</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">t_min_k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">disc_val_1</span><span class="p">,</span> <span class="n">disc_val_2</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.alternative_extrapolation.FromParToForwards" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">FromParToForwards</span><span class="p">(</span><span class="n">term_struct</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">max_runs</span><span class="o">=</span><span class="n">MAX_RUNS</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="n">MAX_ERROR</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts a par rate term structure to forward rates.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>term_struct</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The par rate term structure. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>span</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The span of the forward rates. Defaults to 120.</p>
            </div>
          </td>
          <td>
                <code>120</code>
          </td>
        </tr>
        <tr>
          <td><code>max_runs</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of iterations for convergence. Defaults to MAX_RUNS.</p>
            </div>
          </td>
          <td>
                <code><span title="solvency2_data.alternative_extrapolation.MAX_RUNS">MAX_RUNS</span></code>
          </td>
        </tr>
        <tr>
          <td><code>max_error</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum error for convergence. Defaults to MAX_ERROR.</p>
            </div>
          </td>
          <td>
                <code><span title="solvency2_data.alternative_extrapolation.MAX_ERROR">MAX_ERROR</span></code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.Series: The forward rates term structure.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\alternative_extrapolation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">FromParToForwards</span><span class="p">(</span>
    <span class="n">term_struct</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">span</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span>
    <span class="n">max_runs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">MAX_RUNS</span><span class="p">,</span>
    <span class="n">max_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">MAX_ERROR</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a par rate term structure to forward rates.</span>

<span class="sd">    Args:</span>
<span class="sd">        term_struct (pd.Series, optional): The par rate term structure. Defaults to None.</span>
<span class="sd">        span (int, optional): The span of the forward rates. Defaults to 120.</span>
<span class="sd">        max_runs (int, optional): The maximum number of iterations for convergence. Defaults to MAX_RUNS.</span>
<span class="sd">        max_error (float, optional): The maximum error for convergence. Defaults to MAX_ERROR.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Series: The forward rates term structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">forwards_struct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

    <span class="n">sum_df</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">df</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">previous_maturity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">maturity</span> <span class="ow">in</span> <span class="n">term_struct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">t_min_k</span> <span class="o">=</span> <span class="n">maturity</span> <span class="o">-</span> <span class="n">previous_maturity</span>
        <span class="n">disc_val_1</span><span class="p">,</span> <span class="n">disc_val_2</span> <span class="o">=</span> <span class="n">DiscountedValue4par2forwards</span><span class="p">(</span>
            <span class="n">sum_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">term_struct</span><span class="p">[</span><span class="n">maturity</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">t_min_k</span>
        <span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">disc_val_1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">max_error</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">max_runs</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">disc_val_1</span> <span class="o">/</span> <span class="n">disc_val_2</span>
            <span class="n">disc_val_1</span><span class="p">,</span> <span class="n">disc_val_2</span> <span class="o">=</span> <span class="n">DiscountedValue4par2forwards</span><span class="p">(</span>
                <span class="n">sum_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">term_struct</span><span class="p">[</span><span class="n">maturity</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">t_min_k</span>
            <span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">previous_maturity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maturity</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">forwards_struct</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
            <span class="n">df</span> <span class="o">/=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">forwards_struct</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">sum_df</span> <span class="o">+=</span> <span class="n">df</span>
        <span class="n">previous_maturity</span> <span class="o">=</span> <span class="n">maturity</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">term_struct</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">span</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">forwards_struct</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">forwards_struct</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">forwards_struct</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">span</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.alternative_extrapolation.create_swap_struct" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_swap_struct</span><span class="p">(</span><span class="n">rfr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_swaps</span><span class="o">=</span><span class="p">{})</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Creates a swap structure.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rfr</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The risk-free rate term structure. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>additional_swaps</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional swaps to be included. Defaults to {}.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.Series">Series</span>(dtype=float64)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.Series: The swap structure.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\alternative_extrapolation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_swap_struct</span><span class="p">(</span>
    <span class="n">rfr</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">additional_swaps</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a swap structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        rfr (pd.Series, optional): The risk-free rate term structure. Defaults to None.</span>
<span class="sd">        additional_swaps (dict, optional): Additional swaps to be included. Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Series: The swap structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">swap_struct</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">denom</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">duration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">rfr</span><span class="p">[</span><span class="n">duration</span><span class="p">]</span>
        <span class="n">denom</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rate</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">swap_struct</span><span class="p">[</span><span class="n">duration</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rate</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">duration</span><span class="p">))</span> <span class="o">/</span> <span class="n">denom</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">additional_swaps</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">swap_struct</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">additional_swaps</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">CRA</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="n">swap_struct</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">data</span><span class="o">=</span><span class="n">swap_struct</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.alternative_extrapolation.forwardstruct2termstruct" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">forwardstruct2termstruct</span><span class="p">(</span><span class="n">forward_struct</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Converts a forward rate structure to a term structure.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>forward_struct</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The forward rate structure.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.Series">Series</span>(dtype=float64)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.Series: The term structure.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>solvency2_data\alternative_extrapolation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">forwardstruct2termstruct</span><span class="p">(</span>
    <span class="n">forward_struct</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a forward rate structure to a term structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        forward_struct (pd.Series): The forward rate structure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Series: The term structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alt_term_struct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">forward_struct</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
    <span class="n">alt_term_struct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">forward_struct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">previous_forward</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">alt_term_struct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">forward_struct</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alt_term_struct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">previous_forward</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">forward_struct</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">previous_forward</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alt_term_struct</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">alt_term_struct</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">forward_struct</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<a id="solvency2_data.util"></a>
  <div class="doc doc-contents first">
  
      <p>Common utilities shared across modules</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="solvency2_data.util.get_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_config</span><span class="p">()</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Reads the configuration from the solvency2_data.cfg file.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the configuration settings.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>get_config()
{'[Section1]': {'key1': 'value1', 'key2': 'value2'}, '[Section2]': {'key3': 'value3'}}</p>
</blockquote>
</blockquote>
</blockquote>
</details>
          <details class="quote">
            <summary>Source code in <code>solvency2_data\util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads the configuration from the solvency2_data.cfg file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the configuration settings.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; get_config()</span>
<span class="sd">        {&#39;[Section1]&#39;: {&#39;key1&#39;: &#39;value1&#39;, &#39;key2&#39;: &#39;value2&#39;}, &#39;[Section2]&#39;: {&#39;key3&#39;: &#39;value3&#39;}}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># look in current directory for .cfg file</span>
    <span class="c1"># if not exists then take the .cfg file in the package directory</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;solvency2_data.cfg&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">fname</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">_sections</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="solvency2_data.util.set_config" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_config</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">existing_key</span><span class="o">=</span><span class="s1">&#39;data_folder&#39;</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Sets a new value for the specified key in the configuration file solvency2_data.cfg.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>new_value</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The new value to set for the specified key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>existing_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key whose value needs to be updated. Default is "data_folder".</p>
            </div>
          </td>
          <td>
                <code>&#39;data_folder&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Returns 0 upon successful completion.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>set_config("/new/data/folder", "data_folder")
Download paths updated
0</p>
</blockquote>
</blockquote>
</blockquote>
</details>
          <details class="quote">
            <summary>Source code in <code>solvency2_data\util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_config</span><span class="p">(</span><span class="n">new_value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">existing_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;data_folder&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets a new value for the specified key in the configuration file solvency2_data.cfg.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_value (str): The new value to set for the specified key.</span>
<span class="sd">        existing_key (str): The key whose value needs to be updated. Default is &quot;data_folder&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: Returns 0 upon successful completion.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; set_config(&quot;/new/data/folder&quot;, &quot;data_folder&quot;)</span>
<span class="sd">        Download paths updated</span>
<span class="sd">        0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;solvency2_data.cfg&quot;</span>
    <span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">fname</span><span class="p">)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">existing_key</span> <span class="o">==</span> <span class="s2">&quot;data_folder&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;Directories&quot;</span><span class="p">]:</span>
            <span class="c1"># print(k)</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;Directories&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">configfile</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">configfile</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download paths updated&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.indexes", "navigation.sections", "navigation.tabs"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>